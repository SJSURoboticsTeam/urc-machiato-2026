# Mission Configuration File
# Defines available missions and their parameters

missions:

  # Basic waypoint navigation
  waypoint_navigation:
    name: "Waypoint Navigation Mission"
    type: "waypoint_navigation"
    description: "Navigate between predefined GPS waypoints"
    enabled: true

    # Waypoint definitions
    waypoints:
      - name: "Start Point"
        x: 0.0
        y: 0.0
        z: 0.0
        heading: 0.0
        tolerance: 1.0

      - name: "Checkpoint 1"
        x: 10.0
        y: 5.0
        z: 0.0
        heading: 45.0
        tolerance: 1.0

      - name: "Checkpoint 2"
        x: 20.0
        y: 10.0
        z: 0.0
        heading: 90.0
        tolerance: 1.5

    # Mission parameters
    parameters:
      max_speed: 1.0
      waypoint_timeout: 300.0  # 5 minutes per waypoint
      heading_tolerance: 5.0    # degrees
      completion_criteria: "all_waypoints"  # or "any_waypoint"

  # Object detection and approach
  object_detection:
    name: "Sample Collection Mission"
    type: "object_detection"
    description: "Find and approach geological samples"
    enabled: true

    parameters:
      target_object: "sample"
      search_timeout: 300.0     # 5 minutes
      approach_distance: 0.5    # meters
      vision_timeout: 10.0      # seconds without detection
      search_pattern: "spiral"  # spiral, grid, random

    # Object recognition parameters
    recognition:
      confidence_threshold: 0.7
      size_filter:
        min_width: 50
        min_height: 50
      color_filter:
        enabled: true
        target_hue_range: [20, 40]  # Orange/brown rocks

  # Follow-me mission
  follow_me:
    name: "Follow Me Mission"
    type: "follow_me"
    description: "Follow an ArUco-tagged person/operator"
    enabled: true

    parameters:
      tag_id: 42
      follow_duration: 300.0    # 5 minutes
      desired_distance: 2.0     # meters
      distance_tolerance: 0.5   # meters
      max_follow_speed: 1.0     # m/s
      tag_timeout: 5.0          # seconds before search

    # Safety parameters
    safety:
      min_distance: 1.0         # minimum safe distance
      max_distance: 5.0         # maximum follow distance
      obstacle_avoidance: true

  # Delivery mission
  delivery:
    name: "Sample Delivery Mission"
    type: "delivery"
    description: "Pickup sample and deliver to lander"
    enabled: true

    locations:
      pickup_location:
        name: "Sample Site"
        x: 15.0
        y: 8.0
        z: 0.0
        heading: 180.0
        tolerance: 2.0

      delivery_location:
        name: "Lander"
        x: 25.0
        y: 15.0
        z: 0.0
        heading: 270.0
        tolerance: 1.0

    parameters:
      pickup_operation_time: 10.0   # seconds
      delivery_operation_time: 15.0 # seconds
      carry_speed_limit: 0.5        # slower when carrying
      confirmation_required: true

  # Equipment servicing mission
  equipment_servicing:
    name: "Equipment Servicing Mission"
    type: "equipment_servicing"
    description: "Service equipment at designated locations"
    enabled: true

    waypoints:
      - name: "Travel to Equipment"
        x: 30.0
        y: 20.0
        z: 0.0
        operation: "travel"

      - name: "Equipment Location"
        x: 32.0
        y: 22.0
        z: 0.0
        operation: "service_panel"

      - name: "Sample Delivery Point"
        x: 35.0
        y: 25.0
        z: 0.0
        operation: "deliver_sample"

    operations:
      service_panel:
        duration: 30.0
        requirements: ["arm_reach", "precision_approach"]
        safety_distance: 0.3

      deliver_sample:
        duration: 20.0
        requirements: ["sample_holder", "lander_interface"]
        safety_distance: 0.5

# Mission execution settings
execution:
  default_timeout: 1800.0      # 30 minutes
  emergency_stop_enabled: true
  progress_reporting: true
  data_logging: true

  # Recovery behavior
  recovery:
    max_retries: 3
    retry_delay: 5.0
    fallback_mission: "return_home"

# Hardware configuration
# Note: Hardware settings are environment-specific and should be overridden
# in environment-specific config files (e.g., config/production.yaml)

hardware:
  use_mock: ${HARDWARE_USE_MOCK:true}  # Environment variable override

  # Sensor data sources (environment-specific URLs should be set via env vars)
  sensor_sources:
    websocket:
      url: ${WEBSOCKET_URL:"ws://localhost:8080"}
      enabled: true
      sensors: ["imu", "gps", "battery", "temperature"]

    can_bus:
      interface: ${CAN_INTERFACE:"can0"}
      enabled: ${CAN_ENABLED:false}  # Enable when CAN hardware is connected
      sensors: ["drive_motors", "steering", "encoders"]

    network_cameras:
      enabled: ${CAMERAS_ENABLED:true}
      endpoints:
        - url: ${CAMERA_FRONT_URL:"http://camera1.local:8080"}
          type: "rgb"
          position: "front"
        - url: ${CAMERA_REAR_URL:"http://camera2.local:8080"}
          type: "rgb"
          position: "rear"

  # Actuator configuration
  actuators:
    motors:
      type: "differential_drive"
      max_linear_velocity: 2.0    # m/s
      max_angular_velocity: 1.5   # rad/s
      acceleration_limit: 1.0     # m/s²
      deceleration_limit: 2.0     # m/s²

    led_status:
      enabled: true
      patterns:
        autonomous: "solid_red"
        teleop: "solid_blue"
        emergency: "blinking_red"
        idle: "off"

# Safety parameters
safety:
  emergency_stop:
    enabled: true
    timeout: 0.1  # seconds for hard stop
    recovery_required: true

  obstacle_avoidance:
    enabled: true
    safety_margin: 0.3  # meters
    max_deceleration: 3.0  # m/s²

  boundary_limits:
    enabled: true
    max_distance_from_start: 100.0  # meters
    geofence_violation_action: "return_home"

# Performance monitoring
monitoring:
  enabled: true
  metrics:
    - position_accuracy
    - velocity_tracking
    - sensor_health
    - mission_progress
    - power_consumption

  logging:
    level: "INFO"
    topics: ["/mission/status", "/mission/progress", "/diagnostics"]
    file_rotation: "daily"
